function CustomersController(){}function OrdersController(){}!function(){angular.module("pleasantPastureApp",["firebase","ui.router"]).run(["logProvider","$rootScope","$state","$http","envService","$location",function(e,t,n,r,o,i){e.setLoggingLevels({warn:!0,error:!0,debug:!0,info:!0}),r.get("app/env.json").then(function(e){var t=i.host().replace("www.","").replace(".com","").toLowerCase(),n=e.data[t];if(!n.STRIPE_PUBLIC_KEY)throw new Error("The stripe public key could not be retrieved.  Make sure you have an env.json file configured.");if(o.setStripePublicKey(n.STRIPE_PUBLIC_KEY),!n.PLEASANTPASTURE_API_URL)throw new Error("The pleasant pasture url could not be retrieved.  Make sure you have an env.json file configured.");o.setPleasantPastureAPIUrl(n.PLEASANTPASTURE_API_URL)}),t.$on("$stateChangeStart",function(t,r,o,i,a){e.debug("stateChange","trying to go to state",r),r.redirectTo&&(t.preventDefault(),n.go(r.redirectTo,o,{location:"replace"}))})}])}(),function(){var e="pleasantpasture.firebaseio.com";angular.module("pleasantPastureApp").constant("firebase",{root:new Firebase(e),people:new Firebase(e+"/people"),contacts:new Firebase(e+"/contacts"),testimonials:new Firebase(e+"/testimonials"),events:{valueChanged:"value",childAdded:"child_added",childRemoved:"child_removed"},getCurrentTime:function(){return Firebase.ServerValue.TIMESTAMP},stringify:function(e){var t=e.toString().replace(e.root(),"");for(var n in arguments)arguments[n]!=e&&(t+="/"+arguments[n]);return decodeURIComponent(t)},cleanAngularObject:function(e){if(angular){var t=angular.fromJson(angular.toJson(e));for(n in t)"$"==n.substring(0,1)&&delete t[n];return t}console.error("Angular is not available to use to clean the angular object.  This method doesn't need to be called in this context.")}})}(),function(e){"use strict";e.module("pleasantPastureApp").config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/"),e.state("public",{url:"/",templateUrl:"app/public/public.html",redirectTo:"public.home"}).state("public.home",{url:"home",templateUrl:"app/home/home.html"}).state("public.eggs",{url:"eggs",templateUrl:"app/eggs/eggInfo.html"}).state("public.soap",{url:"soap",templateUrl:"app/Soap/SoapInfo.html"}).state("public.chicken",{url:"chicken",templateUrl:"app/chicken/chicken.html"}).state("public.map",{url:"map",templateUrl:"app/map/map.html"}).state("public.store",{url:"store",template:"<store></store>"}).state("app",{url:"/app",redirectTo:"app.orders",template:"<console></console>"}).state("app.orders",{url:"/orders",template:"<orders></orders>"}).state("app.inventory",{url:"/inventory",template:"<inventory></inventory>"}).state("app.customers",{url:"/customers",template:"<customers></customers>"})}])}(angular),function(){angular.module("pleasantPastureApp").directive("nav",[function(){return{restrict:"E",templateUrl:"app/nav/nav.html",controller:["$scope",function(e){}]}}])}(),function(){angular.module("pleasantPastureApp").controller("peopleController",["$scope","peopleProvider","$rootScope","activityProvider","logProvider",function(e,t,n,r,o){e.people=t.people,e.registerUser=t.registerUser,e.selectPerson=function(e){n.selectedPerson=e,n.selectedDate=new Date,r.reconcileDaysActivities()},t.peopleLoaded.then(function(){e.people.length>0&&(n.selectedPerson=e.people[0])})}])}(),function(){angular.module("pleasantPastureApp").directive("testimonials",[function(){return{restrict:"",templateUrl:"app/testimonials/testimonials.html",controller:["$scope","firebase","firebaseArrayWatcher",function(e,t,n){e.testimonials=n.getWatcher(t.testimonials.orderByChild("product").equalTo("soap"))}]}}])}(),function(){"use strict";angular.module("pleasantPastureApp").component("console",{templateUrl:"app/components/console/console.html",controller:"ConsoleController",controllerAs:"console"}).controller("ConsoleController",function(){var e=this;e.title="Console"})}(),function(){angular.module("pleasantPastureApp").component("customers",{templateUrl:"app/components/customers/customers.html",controller:CustomersController,controllerAs:"customersController"})}(),function(){function e(){}angular.module("pleasantPastureApp").component("inventory",{templateUrl:"app/components/inventory/inventory.html",controller:e,controllerAs:"inventoryController"})}(),function(){angular.module("pleasantPastureApp").component("orders",{templateUrl:"app/components/orders/orders.html",controller:OrdersController,controllerAs:"ordersController"})}(),function(){function e(e,t,n){function r(){return t(function(e){B.selectedShippingOption=!1,B.paying=!1,B.selectedShippingOption=null,B.shippingOptions=[],B.selectingShipping=!1,B.checkoutSuccessful=!0,e()})}function o(){return t(function(e,t){n.processing=!0,e()})}function i(){return t(function(e,t){n.processing=!1,e()})}function a(e){var t=e.skus.data[0],n=B.cart.items.find(function(e){return t.id===e.id});t.inventory.quantity>0&&(e.id=t.id,e.price=t.price,n?u(n):(e.quantity=1,B.cart.items.push(e),l()),t.inventory.quantity--,d())}function c(e){B.cart.items.splice(B.cart.items.indexOf(e),1),l(),0==B.cart.total&&p()}function u(e){e.quantity++,l()}function s(e){e.skus.data[0].inventory.quantity++,1===e.quantity?c(e):(e.quantity--,l())}function l(){var e=B.cart.items.reduce(function(e,t){return e+t.price/100*t.quantity},0),t=B.cart.items.reduce(function(e,t){return e+(t["static"]?0:t.quantity)},0);B.cart.total=e,B.cart.itemCount=t}function p(){return t(function(e,t){B.canCheckOut=!1,e()})}function d(){return t(function(e,t){B.canCheckOut=!0,e()})}function f(){B.shopping=!0,B.checkoutSuccessful=!1,v().then(function(){B.cart.items=[],B.cart.total=0,B.cart.itemCount=0})}function h(e){return t(function(t,n){B.inventory=e,t(e)})}function m(e){return t(function(t,n){e.sort(function(e,t){return parseInt(e.metadata.order)-parseInt(t.metadata.order)}),t(e)})}function g(){return t(function(t,n){B.order.items=[],B.order.id?(B.canPay=!1,e.cancelOrder(B.order).then(v).then(t)):t()})}function v(){return t(function(e,t){var n=B.order.shipping.address,r=B.order.email,o=B.order.shipping.name;B.order={currency:"usd",items:[],shipping:{address:{line1:n.line1,line2:n.line2,postal_code:n.postal_code,country:"US"},name:o}},B.order.email=r,e()})}function y(e){return t(function(t,n){i().then(function(){"out_of_inventory"==e.code?B.createOrderError="One or more items are out of stock":"shipping_calculation_failed"==e.data.code?B.createOrderError="We could not find your address":B.createOrderError="Something went wrong finding shipping options.  You may want to start over."})["catch"](console.error),n("bad address")})}function P(){return t(function(e,t){B.cart.items.forEach(function(e){B.order.items.push({type:"sku",quantity:e.quantity,parent:e.id})}),e(B.order)})}function b(e){return t(function(t,n){B.order=e,t(e)})}function S(){return t(function(e,t){B.createOrderError=null,e()})}function A(e){var n=e.shipping_methods;return t(function(e,t){for(var r=n.sort(function(e,t){var n=new Date(e.delivery_estimate.date||e.delivery_estimate.earliest),r=new Date(t.delivery_estimate.date||t.delivery_estimate.earliest);return r-n}),o=1;o<r.length;o++)for(var i=0;o>i;i++)r[o].amount<r[i].amount&&(r[i].ridiculous=!0);e(r.filter(function(e){return!e.ridiculous}))})}function w(e){return t(function(t,n){e.forEach(function(e){var t=new Date(e.delivery_estimate.date||e.delivery_estimate.earliest);if(t.setDate(t.getDate()+3),e.delivery_estimate.date=t,e.delivery_estimate.earliest=t,e.delivery_estimate.latest){var n=new Date(e.delivery_estimate.latest);e.delivery_estimate.latest=n.setDate(n.getDate()+3)}}),t(e)})}function O(){return t(function(e,t){B.updatingShipping=!1,e()})}function C(e){return t(function(t,n){B.updatingShipping=!0,t(e)})}function U(e){return t(function(t,n){B.order.selected_shipping_method=e.id,t(B.order)})}function E(e){return t(function(t,n){B.selectedShippingOption=e,t(e)})}function $(e){return t(function(t,n){B.shippingOptions=e,t(B.shippingOptions)})}function _(){return t(function(e,t){B.addressError=!1,e()})}function k(){o().then(S).then(g).then(I).then(P).then(e.creatOrder).then(b,y).then(A).then(w).then($).then(_).then(i)["catch"](console.error)}function I(){return t(function(e,t){B.shippingOptions=[],B.selectedShippingOption=null,T().then(e)["catch"](console.error)})}function T(){return t(function(e,t){var n=B.cart.items.find(function(e){return 1==e.shippingItem});n&&B.cart.items.splice(B.cart.items.indexOf(n),1),e()})}function q(e){return t(function(t,n){B.cart.items.push({name:e.description,price:e.amount,quantity:1,"static":!0,shippingItem:!0}),l(),t(e)})}function D(t){K().then(C).then(T).then(function(){return q(t)}).then(E).then(U).then(e.updateOrder).then(b).then(O).then(x).then(p)["catch"](console.error)}function L(){T(),B.selectingShipping=!1,B.shopping=!0}function R(){return t(function(t,n){e.createToken(B.cardInfo).then(t)["catch"](n)})}function M(e){return t(function(t,n){B.paymentErrorMessage=e.message||e,i().then(x).then(function(e){n(e)})})}function W(e){return t(function(t,n){B.paymentErrorMessage=e&&e.data&&e.data.message?e.data.message:e&&e.message?e.message:"There was an error charging your card.",i().then(x).then(n)})}function F(){return t(function(e,t){B.paymentErrorMessage=null,x().then(e)})}function j(){o().then(F).then(K).then(R).then(function(t){return e.chargeCard(t,B.order)},M).then(r,W).then(i)["catch"](console.error)}function K(){return t(function(e){B.canPay=!1,B.processingPayment=!0,e()})}function x(){return t(function(e,t){B.canPay=!0,B.processingPayment=!1,e()})}function Y(){g().then(I).then(K).then(d).then(C).then(v).then(function(){B.selectedShippingOption=!1,B.paying=!1,B.updatingShipping=!1,B.shopping=!0})["catch"](console.error)}var B=this;B.inventory=[],B.cart={total:0,itemCount:0,items:[]},B.selectingShipping=!1,B.updatingShipping=!1,B.processingPayment=!1,B.paying=!1,B.shopping=!0,B.canPay=!1,B.selectedShippingOption=null,B.canCheckOut=!1,B.order={currency:"usd",items:[],shipping:{address:{country:"US"}}},B.shippingOptions=[],B.yearOptions=[],B.addressError=!1,B.paymentErrorMessage=null,B.addItem=a,B.increment=u,B.decrement=s,B.payForOrder=j,B.getShippingOptions=k,B.selectShipping=D,B.cancelOrder=Y,B.cancelShipping=L,B.continueShopping=f,o().then(e.getInventory).then(m).then(h).then(i)["catch"](console.error);for(var N=(new Date).getFullYear(),J=N,V=0;V<8;V++)B.yearOptions.push(J++)}angular.module("pleasantPastureApp").component("store",{templateUrl:"app/components/store/store.html",controller:["stripeService","$q","$rootScope",e],controllerAs:"storeController"})}(),function(){angular.module("pleasantPastureApp").directive("contactForm",[function(){return{restrict:"E",templateUrl:"app/forms/contact/contactForm.html",controller:["$scope","firebase",function(e,t){e.saved=!1,e.contact={},e.saveContact=function(){t.contacts.push(e.contact,function(){e.saved=!0,e.$digest()})}}]}}])}(),function(){angular.module("pleasantPastureApp").directive("focusWhen",function(e,t){return{link:function(n,r,o){var i=t(o.focusWhen);n.$watch(i,function(t){t===!0&&e(function(){r[0].focus()},100)})}}})}(),function(){angular.module("pleasantPastureApp").directive("ngEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.ngEnter)}),t.preventDefault())})}})}(),function(){angular.module("pleasantPastureApp").service("envService",function(){var e="",t="";this.setStripePublicKey=function(t){e=t},this.setPleasantPastureAPIUrl=function(e){t=e},this.getStripePublicKey=function(){if(""==e||null==e||void 0==e)throw new Error("The Stripe public key was not set.  Make sure you have an env.json file in your environment.");return e},this.getPleasantPastureAPIUrl=function(){if(""==t||null==t||void 0==t)throw new Error("The pleasant pasture api url was not set.  Make sure you have an env.json file in your environment.");return t}})}(),function(){angular.module("pleasantPastureApp").service("firebaseArrayWatcher",["firebase","$firebaseArray","logProvider",function(e,t,n){var r={};this.getWatcher=function(n,o){if(!r[n]){r[n]=[];var i=t(n);o&&i.$loaded(function(){o.resolve()}),i.$watch(function(t){if(t.event===e.events.childAdded)r[n].push(i.$getRecord(t.key));else if(t.event===e.events.childRemoved){var o=r[n].find(function(e){return e.$id==t.key});r[n].splice(r[n].indexOf(o),1)}})}return r[n]}}])}(),function(){angular.module("pleasantPastureApp").service("logProvider",["firebase",function(e){function t(e,t,n,r){var t=t?"["+t+"]: ":"";"undefined"!=typeof r?console[e](t+n+":",r):console[e](t+n)}var n={warn:!1,info:!1,debug:!1,error:!0};this.setLoggingLevels=function(e){n.warn=e.warn,n.info=e.info,n.debug=e.debug,n.error=e.error},this.info=function(e,r,o){n.info&&t("info",e,r,o)},this.warn=function(e,r,o){n.warn&&t("warn",e,r,o)},this.error=function(e,r,o){n.error&&t("error",e,r,o)},this.debug=function(e,r,o){n.debug&&t("debug",e,r,o)}}])}(),function(e,t){e.module("pleasantPastureApp").service("stripeService",["$q","$http","envService",function(e,n,r){function o(){return e(function(e,t){n.get(l+"products").then(function(t){e(t.data.data)})})}function i(t,r){return e(function(e,o){n.post(l+"charge",{token:t,orderId:r.id,email:r.email}).then(function(t){console.log("card charge success",t),e(t.data)},function(e){console.log("card charge error",e),o(e)})})}function a(t){return e(function(e,r){n.post(l+"order",t).then(function(t){e(t.data)},function(e){r(e)})})}function c(t){return e(function(e,r){n.put(l+"order",t).then(function(t){e(t.data)},function(e){r(e)})})}function u(t){return e(function(e,r){n["delete"](l+"order/"+t.id).then(function(t){e(t.data)},function(e){r(e)})})}function s(n){return e(function(e,r){t.card.createToken(n,function(t,n){n.error?r(n.error):e(n.id)})})}t.setPublishableKey(r.getStripePublicKey());var l=r.getPleasantPastureAPIUrl();this.getInventory=o,this.chargeCard=i,this.creatOrder=a,this.updateOrder=c,this.createToken=s,this.cancelOrder=u}])}(angular,Stripe),function(){angular.module("pleasantPastureApp").service("peopleProvider",["$q","firebase","firebaseArrayWatcher","logProvider","$rootScope",function(e,t,n,r,o){function i(e){r.info("peopleProvider","authInfo provided to setUserInfo",e);var n={imgPath:e.google.profileImageURL,name:e.google.displayName};r.info("peopleProvider","userInfo from auth",n),t.people.child(e.uid).set(n)}var a=e.defer();this.people=n.getWatcher(t.people,a),this.peopleLoaded=a.promise,this.registerUser=function(){r.info("peopleProvider","user being registered"),t.root.unauth(),t.root.authWithOAuthPopup("google",function(e,t){e?console.error("couldn't log the user in",e):(r.info("peopleProvider","user info retrieved from google",t),i(t))})}}])}(),function(){angular.module("pleasantPastureApp").directive("map",[function(){return{restrict:"E",templateUrl:"app/global/content/map/map.html",controller:["$scope",function(e){}]}}])}();